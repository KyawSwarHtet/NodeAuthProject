"use strict";var jwt=require("jsonwebtoken"),asyncHandler=require("express-async-handler"),User=require("../model/userModel"),protect=asyncHandler(function(r,t,a){var o,s;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(r.headers.authorization&&r.headers.authorization.startsWith("Bearer"))return e.prev=1,o=r.headers.authorization.split(" ")[1],s=jwt.verify(o,"".concat(process.env.JWT_SECRET)),e.next=6,regeneratorRuntime.awrap(User.findById(s.id).select("-password"));e.next=15;break;case 6:r.user=e.sent,r.user?a():t.status(403).json("You are not allow to do that!"),e.next=15;break;case 10:throw e.prev=10,e.t0=e.catch(1),console.log(e.t0),t.status(401),new Error("Not authorized");case 15:if(o){e.next=18;break}throw t.status(404),new Error("Not authorized, no token");case 18:case"end":return e.stop()}},null,null,[[1,10]])});module.exports={protect:protect};
//# sourceMappingURL=authMiddleware.min.js.map
